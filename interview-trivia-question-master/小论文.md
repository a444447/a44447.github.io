# Title

## Abstract

## Introduction

## Related Work

## Motivation

近年来，针对感知系统模型的物理世界对抗性攻击主要依赖两类载体：**贴附于车体表面的印刷式补丁（printed patch）**，以及**通过车载显示屏展示的动态补丁（screen-based dynamic patch）**。尽管这些方法在数字仿真中能够显著降低目标检测器的置信度，但在真实物理环境下的可迁移性仍然极为有限。印刷类贴片容易受到户外环境中磨损、褪色或几何变形的影响，从而破坏优化得到的对抗模式；而屏幕类方法（如 **Hoory 等人提出的动态屏幕补丁**）虽然具有一定的视角自适应能力，却在强光照或镜面反射条件下表现显著退化。 正如其研究所指出的，高反射率屏幕表面对环境光高度敏感，使得此类策略难以在开放场景下稳定发挥作用。

![绘图1](assets/绘图1.png)

**Fig. 1.**Comparison of existing physical attack carriers.

这些失败模式揭示了一个关键缺口——**数字成功与物理鲁棒性之间的矛盾**。理想的物理对抗载体必须同时满足三项要求：(1) 能在自然光照和视角变化下保持攻击效果；(2) 具备良好的隐蔽性，不破坏车辆外观；(3) 能在不同感知模型间保持泛化能力。为弥补这一缺口，我们提出一种基于**车载 LED 光源的照明型对抗范式**。与改变表面外观的贴片或屏幕不同，LED 通过可控的光照变化间接扰动传感器输入，实现局部、可调的辐射和阴影调制。这一特性使得 LED 攻击在物理环境中更加稳健，可重复配置且无需损伤车体。

我们的初步实验验证了特定 **位置、颜色与亮度组合的 LED** 可显著降低检测器置信度。例如，靠近车轮拱位置的灯组以及发射绿–蓝波段的光源具有更强的干扰效果。

![绘图motivation2](assets/绘图motivation2-1761796168222-4.png)

这些实证结果引出了我们的核心问题：

+ *如何通过算法化手段搜索在隐蔽性约束下最优的 LED 组合以最大化攻击效果*
+ *同一组LED组合是否能在多种感知模型间保持攻击迁移性*


## 针对目标检测的攻击方法



### Problem Formulation

#### **A. LED 参数表示（LED Parameter Representation**

假设车辆上安装有 $N$ 个可独立控制的 LED 光源，编号为 $i = 1, 2, ..., N$。
 每个 LED $i$ 由四个连续可控参数构成：
$$
\theta_i = [bri_i, r_i, g_i, b_i],
$$
其中 $bri_i \in [0,1]$ 表示亮度强度，$(r_i, g_i, b_i) \in [0,1]^3$ 分别为 RGB 三通道颜色值。
 因此，整个系统的参数向量可表示为一个 $4N$ 维向量：
$$
\Theta = [\theta_1, \theta_2, \ldots, \theta_N].
$$
该优化空间具有 **高维度、连续性、非凸性与不可导性** 等特征，且攻击模型为黑盒，仅可通过输出置信度进行查询，因此无法直接采用梯度方法优化。
 针对上述困难，我们设计了一个 **两阶段进化式优化框架**，以高效搜索 LED 参数并获得稳定的攻击结果。

#### **B. 攻击目标与约束条件（Attack Objective and Constraints）**

本文研究一种物理世界对抗性攻击场景：在车辆表面安装可控的 LED 光源，以干扰由外部摄像头采集的图像，使运行在摄像头上的目标模型产生误判。用 $\mathcal{L}_{\text{model}}^{(j)}(I)$ 表示第 $j$ 个模型在图像 $I$ 上的损失。给定未受扰动的原始图像 $I_0$，当 LED 配置为 $\Theta$ 时，相机捕获的图像记为 $I(\Theta)$。我们的目标是在满足物理约束的条件下，找到一个最优的 LED 参数组合 $\Theta^*$，以最小化模型置信度并保持视觉隐蔽性。总体对抗目标写为
$$
\min_{\Theta\in\Omega}\; \mathcal{L}_{attack}(\Theta)
= \sum_{j=1}^{M} \alpha_j\,\mathcal{L}_{\text{model}}^{(j)}\big(I(\Theta)\big)
+ \lambda_{vis}\,\mathcal{L}_{vis}\big(I(\Theta),I_0\big),
$$
其中 $\{\alpha_j\}$ 为非负的模型权重（可归一化），$\mathcal{L}_{vis}$ 衡量视觉可感知性，$\Omega$ 为 LED 的物理可行域。

### **Framework Overview**

为在受约束的高维 LED 参数空间中实现高效搜索，我们提出一个**两阶段黑盒优化框架**，包含：

1. **阶段一（Coarse Search, PSO）：** 在简化的二值空间中进行离散搜索，选择对抗潜力较高的 LED 子集；
2. **阶段二（Fine-Tuning, CMA-ES）：** 在选定子集上进行亮度与颜色的连续优化，实现精细化调整。

这种“粗到细”的策略在非凸、噪声较大的物理扰动空间中，能够显著提升搜索效率与收敛稳定性。

### **Coarse Serach**

#### 1）问题简化

在粗搜索阶段，固定所有 LED 的颜色与亮度为预设值（如紫色），仅优化每个 LED 的开关状态。
 设 $z_i \in \{0,1\}$ 表示第 $i$ 个 LED 是否点亮。粒子位置向量 $x_i \in [0,1]^N$ 采用连续编码，并通过阈值或采样方式离散化：
$$
z_i = \mathbb{I}[x_i > \tau].
$$

#### 2）PSO 更新规则

采用带局部邻域拓扑的 **l-best PSO** 以鼓励多样性，并引入收缩因子 $\chi$ 保证收敛稳定。速度与位置更新公式为：
$$
v_i^{(t+1)} = \chi \Big[ v_i^{(t)} + c_1 r_1 (p_i - x_i^{(t)}) + c_2 r_2 (l_i - x_i^{(t)}) \Big],
$$
其中 $p_i$ 为个体最优位置，$l_i$ 为局部邻域最优。

#### 3）子集输出

每个粒子对应一个 LED 子集 $\mathcal{S}_i = \{ j \mid z_{ij}=1 \}$。
 经过多次迭代后，选取若干损失最小的前 $k$ 个子集作为候选，进入细调阶段。

### **Fintuning Search	**

#### 1）实数域搜索与 Sigmoid 映射

对每个候选子集 $\mathcal{S}$，使用 **协方差矩阵自适应进化策略（CMA-ES）** 在连续空间优化参数 $\Theta_\mathcal{S}$。
 为同时保持 CMA-ES 的统计自适应性与物理边界约束，我们在无界实数域 $\hat{\Theta} \in \mathbb{R}^d$ 中搜索，并通过 Sigmoid 函数映射到区间 $[0,1]^d$：
$$
\theta = \sigma(\hat{\theta}) = \frac{1}{1+e^{-\hat{\theta}}}.
$$
实验中，将 $\hat{\theta}$ 初始化在 $[-6,6]$ 区间，以覆盖接近完整的物理可控范围。

#### 2）采样与更新

第 $t$ 次迭代时，从多元高斯分布中采样：
$$
\hat{\Theta}^{(t)}_k \sim \mathcal{N}(m^{(t)}, (\sigma^{(t)})^2 C^{(t)}),
$$
随后依据标准 CMA-ES 过程进行均值 $m^{(t)}$、步长 $\sigma^{(t)}$ 与协方差矩阵 $C^{(t)}$ 的 rank-μ 与 rank-1 更新。

#### 3）多次重启策略

为增强稳定性，对每个候选子集执行 $K$ 次独立 CMA-ES 运行（不同随机种子与初始参数）：
$$
\Theta^* = \arg\min_{k=1,\dots,K} \mathcal{L}_{attack}(\Theta_k),
$$
通常 $K=3$。

#### 4）早停机制

当检测器置信度 $\mathcal{L}_{det}$ 低于设定阈值，或连续若干迭代无改进时，提前终止优化。

------



## 多模型攻击方法

### Problem Formulation

### **A.适应度函数与自适应权重机制（Fitness Function and Adaptive Weighting）**

整体适应度函数定义为：
$$
\mathcal{L}_{attack} =
\lambda_{det} \sum_{b\in B} \text{conf}(b)
+ \lambda_{vis} \|I(\Theta)-I_0\|_2
+ \lambda_{cls} f_{cls}(I(\Theta))_{y_0},
$$
其中 $B$ 表示检测器输出的边界框集合，$y_0$ 为原始类别。

由于三项损失间可能存在冲突，我们设计了基于滑动窗口相关性的 **自适应权重调节机制**。
 计算不同损失的一阶差分相关系数 $r_{ij} = \text{corr}(\Delta L_i, \Delta L_j)$：

- 当可见度损失 $L_{vis}$ 或分类损失 $L_{cls}$ 与检测器损失负相关时，增加其惩罚权重；
- 当二者正相关且副任务误差已低于阈值 $T_{vis}, T_{cls}$ 时，适度降低权重；
- 最终权重进行裁剪与归一化以保持 $\sum \lambda_i$ 恒定。

该机制可在优化过程中动态平衡攻击效果与视觉隐蔽性。

**E. 实现细节（Implementation Details）**

所有仿真均在 **Blender** 环境下完成，采用物理精确渲染（PBR）管线。
 LED 的安装位置与朝向根据车辆模型预设，并在实际硬件上（WS2812B 阵列 + 控制器）复现相同布局，用于验证仿真到现实的迁移性。
 PSO 种群规模与 CMA-ES 参数均采用标准设置，默认：PSO 种群数 30，迭代 50 次；CMA-ES 重启 3 次，单次种群数 15。
 当检测置信度低于 0.05 时，触发早停终止当前运行。

## Experiment

### Discussion and Limitations

## Conclusion



# 新结构

![9239B840B799CC3DA35F208B6FCF15B4](assets/9239B840B799CC3DA35F208B6FCF15B4.png)



## Problem Formulation

给定一个真实物体的 3D mesh 模型，我们定义一组可放置 LED 的候选点集合：
$$
\mathcal{P} = \{p_1, p_2, \dots, p_N\}.
$$
目标是在其中选择一个 LED 子集 $\mathcal{S}\subseteq\mathcal{P}$，并为每个 LED 设置颜色与亮度参数，使得在渲染图像输入目标检测器后，其对指定前景类别（如 car）的检测与识别性能受到最大干扰。

设目标检测器的前向输出为 $F(\cdot)$。给定 LED 参数 $\Theta$ 以及 LED 选址向量 $\mathbf{x}$，渲染器生成图像：
$$
\mathbf{I} = R(\mathbf{x}, \Theta).
$$
攻击者的优化目标是最小化综合攻击损失：
$$
\min_{\mathbf{x}, \Theta} f(\mathbf{x}, \Theta)=
\lambda_1 \mathcal{L}_{\mathrm{IoU}}
+ \lambda_2 \mathcal{L}_{\mathrm{obj}}
+ \lambda_3 \mathcal{L}_{\mathrm{cls}}
+ \lambda_4 \mathcal{L}_{\mathrm{stealth}}.
$$
其中：

- $\mathcal{L}_{\mathrm{IoU}}$：基于 IoU 的定位干扰
- $\mathcal{L}_{\mathrm{obj}}$：objectness 降低
- $\mathcal{L}_{\mathrm{cls}}$：错误分类
- $\mathcal{L}_{\mathrm{stealth}}$：基于 L2 范数的隐蔽性约束

由于该优化包含 **离散 + 连续** 的混合变量且高度非凸，我们采用两阶段优化策略进行求解。


## Method

### Overall Framework

Fig. X 展示了我们提出的三阶段物理世界 LED 对抗攻击框架。考虑到直接在真实环境中进行搜索与验证的成本较高，我们首先利用三维重建技术构建目标物体的精确 3D 模型，并在模拟环境中完成对 LED 参数的优化搜索。

整个方法包含两个核心优化阶段。首先，在 **Stage 1** 中，我们基于改进的粒子群优化方法（PSO），在固定颜色与亮度的前提下，对大规模候选位置空间进行搜索，从而筛选出对模型最具干扰性的关键 LED 布置位置。随后，**Stage 2** 以阶段一输出的 LED 子集为基础，采用改进的协方差矩阵自适应进化策略（CMA-ES），进一步对 LED 的颜色与亮度参数进行精细化优化，得到最终的对抗 LED 模式。

在完成虚拟空间中的搜索与优化后，我们将得到的 LED 模式应用到真实物理场景中，以验证其跨域的攻击效果。

### Physical Attack Space Construction

在物理世界中进行对抗性样本攻击往往需要搭建真实场景并多次试验，其成本高昂且缺乏可控性，因此许多方法选择先在模拟环境中完成设计与优化。为了避免从零搭建虚拟场景所需的专业建模成本，我们利用三维重建技术获取攻击目标的精确几何结构。具体而言，我们对真实物体进行扫描并重建其高保真 3D mesh，将其导入 Blender 作为虚拟场景的基础模型。为构建可控的物理攻击空间，我们在 Blender 中将重建得到的 3D mesh 与预先创建的 LED 发光体模型进行组合。为了避免在连续的表面上进行高维位置搜索，我们在目标物体的表面上布置了一组离散的可选 LED 放置点。这些候选位置作为后续优化阶段的搜索空间，其中 Step 2 的粗搜索将在这一集合中选择最具攻击效果的 LED 子集。

### Coarse Search for LED Positioning

在物体表面布置的 LED 候选点数量通常非常庞大（几十到数百个），其组合空间呈指数级增长，使得连续参数化优化难以直接处理。因此，我们首先进行一个粗搜索阶段，用于在离散候选集合中选择一组最具攻击性的 LED 位置，从而显著缩小后续颜色与亮度优化的搜索空间。

**Search Space Definition**

给定在 Blender 中事先布置的 **N 个 LED 候选位置**
$$
\mathcal{P}=\{p_1,p_2,\dots,p_N\},
$$
我们的目标是在其中选取一个子集 $\mathcal{S}\subseteq \mathcal{P}$，使得所生成的 LED 激发模式能够最大化对目标模型的干扰。

我们通过二元向量
$$
\mathbf{x}=[x_1,x_2,\dots,x_N], \quad x_i\in\{0,1\}
$$
来表示 LED 是否被激活，其中 $x_i=1$ 表示选择第 i 个 LED。

在此阶段，LED 的颜色与亮度均保持为默认值（例如白光 + 固定强度），以降低优化维度并隔离**位置本身**的影响。

**Fitness Evaluation**

为评估每个候选 LED 子集的攻击效果，我们设计了同时考虑 **攻击性（aggressiveness）** 与 **隐蔽性（stealthiness）** 的综合损失函数。给定由粒子向量 $\mathbf{x}$ 生成的图像 $\mathbf{I}(\mathbf{x})$，我们将其输入目标检测模型以获得预测结果，并基于以下四项指标计算 fitness。

**1）定位攻击（基于 IoU 的位置破坏）**

为了降低检测器对目标物体的定位能力，我们最大化预测框与真实框之间的误差。具体地，我们使用 IoU-based 损失构造如下项：
$$
\mathcal{L}_{\text{IoU}} = 1 - \mathrm{IoU}(B_{\text{pred}}, B_{\text{gt}})
$$
其中 $B_{\text{pred}}$ 为预测框，$B_{\text{gt}}$ 为真实框。越大的 $\mathcal{L}_{\text{IoU}}$ 表示定位能力越差。

**2）目标存在性攻击（Objectness 降低）**

为了降低检测器对前景物体的检测能力，我们最小化 YOLO 输出的 objectness 分数：
$$
\mathcal{L}_{\text{obj}} = o_{\text{pred}}
$$
其中 $o_{\text{pred}}$ 为置信度最高的前景候选框的 objectness 值。

**3）类别攻击（错误分类）**

即使检测器仍能定位目标，攻击仍需进一步破坏正确类别识别，因此我们最小化 “car” 的类别概率：
$$
\mathcal{L}_{\text{cls}} = p_{\text{car}}
$$
此项越大，表示仍能正确识别为 car，因此需将其压低。

**4）隐蔽性约束（L2 范数）**

为了减少 LED 所造成的视觉扰动、提升攻击的可隐蔽性，我们使用渲染前后图像的 L2 范数：
$$
\mathcal{L}_{\text{stealth}} = \| \mathbf{I}(\mathbf{x}) - \mathbf{I}_0 \|_2
$$
其中 $\mathbf{I}_0$ 为无 LED 的参考图像。

结合上述四项，我们的 fitness 定义为：
$$
f(\mathbf{x}) = 
\lambda_1 \mathcal{L}_{\text{IoU}} +
\lambda_2 \mathcal{L}_{\text{obj}} +
\lambda_3 \mathcal{L}_{\text{cls}} +
\lambda_4 \mathcal{L}_{\text{stealth}}
$$
改进PSO 的优化目标是：
$$
\min_{\mathbf{x}} f(\mathbf{x})
$$
其中 $\lambda_1,\lambda_2,\lambda_3,\lambda_4$ 为权重参数

**Optimization via an Improved PSO**

为在大规模离散 LED 位置空间中进行高效搜索，我们构建了一种结合 **邻域最优引导（local-best topology）** 与 **局部经验遗忘（local-experience forgetting）** 的改进型粒子群优化方法。该方法旨在增强早期探索能力，同时保留后期收敛稳定性。

在标准 PSO 中，粒子受到三个因素驱动：惯性项、个人历史最优位置（pbest）、以及全局最优（gbest）。然而在 LED 子集搜索任务中，全局最优往往导致过强的集中收敛，使粒子群难以跨越不同组合区域。为提升多样性，我们采用 **邻域拓扑结构**，使每个粒子仅受其 **局部邻域最优位置（lbest）** 引导：
$$
v_i^{(t+1)} =
\omega v_i^{(t)}
+ c_2 r_2 \left(l_i^{(t)} - x_i^{(t)}\right),
$$
其中 $l_i^{(t)}$ 为粒子 i 所在邻域中的最优位置。
 这种局部拓扑可有效避免全局最优导致的早期收敛。

进一步地，为增强早期阶段在组合空间中的探索深度，我们在初始若干轮中 **移除个人最优项 pbest**（即“局部经验遗忘”策略），从而暂时避免粒子被自身经验束缚，获得更大的搜索自由度。随着迭代的推进，我们逐步恢复 pbest，使算法从探索阶段平滑过渡至收敛阶段。恢复后的速度更新形式为：
$$
v_i^{(t+1)} =
\omega v_i^{(t)}
+ c_1 r_1 \left(p_i^{(t)} - x_i^{(t)}\right)
+ c_2 r_2 \left(l_i^{(t)} - x_i^{(t)}\right).
$$


### Fine-tuning of LED Color and Brightness

在完成 LED 位置的粗搜索后，我们获得了一组最具攻击潜力的 LED 子集。然而位置本身仅决定扰动的空间分布；LED 的发光颜色（RGB）与亮度（intensity）则直接决定视觉扰动的形态与强度，因此进一步的连续参数优化对于实现高质量物理攻击至关重要。为此，我们在固定位置子集 $\mathcal{S}$ 的基础上，引入协方差矩阵自适应进化策略（CMA-ES），对颜色与亮度进行细粒度优化。

**Parameterization and Value Scaling**

对于粗搜索阶段选中的 $K = |\mathcal{S}|$ 个 LED，我们为每个 LED 定义四维连续参数向量：
$$
\theta_i = [r_i, g_i, b_i, \alpha_i],\quad i=1,\dots,K,
$$
其中 $r_i, g_i, b_i \in [0,1]$ 表示 RGB 通道，$\alpha_i\in[0,1]$ 表示归一化亮度。

然而，CMA-ES 在优化过程中可能产生超出 $[0,1]$ 的值，而直接裁剪（clipping）会破坏协方差更新的连续性，导致进化方向失真，最终影响收敛质量。为避免这一问题，我们采用 **无界搜索 + Sigmoid 映射** 的参数化方式，将 CMA-ES 的搜索变量定义在：
$$
z_i \in [-6, 6],
$$
渲染前通过 Sigmoid 映射到有效物理范围：
$$
\theta_i = \sigma(z_i) = \frac{1}{1 + e^{-z_i}}.
$$
对于亮度，最终的发光强度为：
$$
\mathrm{intensity}_i = \theta_{i,\alpha} \cdot \mathrm{base},
$$
其中 base 为 LED 的物理亮度上限。

这种 Z-space 到 Θ-space 的解耦方式避免了裁剪造成的搜索方向破坏，并在边界区域提供更平滑、更稳定的搜索行为。

**Fitness Evaluation**

颜色与亮度优化沿用粗搜索阶段设计的综合损失函数，包括：

- **定位干扰损失** $\mathcal{L}_{\mathrm{IoU}}$
- **存在性攻击损失（objectness）** $\mathcal{L}_{\mathrm{obj}}$
- **类别攻击损失（classification）** $\mathcal{L}_{\mathrm{cls}}$
- **隐蔽性损失（L2 范数）** $\mathcal{L}_{\mathrm{stealth}}$

整体目标为最小化：
$$
f(\Theta)=
\lambda_1 \mathcal{L}_{\text{IoU}}
+ \lambda_2 \mathcal{L}_{\text{obj}}
+ \lambda_3 \mathcal{L}_{\text{cls}}
+ \lambda_4 \mathcal{L}_{\text{stealth}}.
$$
**Optimization via CMA-ES**

CMA-ES 在 Z-space 中进行搜索，其采样机制为：
$$
Z_j^{(t)} = \mu^{(t)} + \sigma^{(t)} \mathcal{N}(0, \Sigma^{(t)}),
$$
然后映射至 LED 参数空间：
$$
\Theta_j^{(t)} = \sigma(Z_j^{(t)}).
$$
协方差自适应更新如下：
$$
\mu^{(t+1)} = \sum_{j=1}^{\lambda} w_j \Theta_j^{(t)},
$$
该机制可自适应地学习 RGB 与亮度参数之间的耦合关系，从而适应光照扰动在渲染图像中的复杂传播特性。

**k-random Start for Stability**

由于该优化属于高维非凸连续空间，仅依赖单次 CMA-ES 可能陷入局部最优。为提升稳定性与鲁棒性，我们引入 **k-random start** 策略：从 $k$ 个不同的随机初始均值 $\mu^{(0)}_1,\dots,\mu^{(0)}_k$ 启动独立的 CMA-ES 运行。每次运行均在 Z-space 中执行，最终从所有运行中选择损失最小的解：
$$
\Theta^* = \arg\min_{\Theta^{(s)}} f(\Theta^{(s)}), \quad s=1,\dots,k.
$$
该策略显著降低了初始化敏感性，有效提升了 LED 颜色与亮度优化的稳定性。

